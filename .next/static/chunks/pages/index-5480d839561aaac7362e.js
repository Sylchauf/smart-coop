(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{6286:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ie}});var r=n(5893),a=n(4012),s=n(1788),i=n(9586),o=n(9969),l=n(7294),u=n(615),c=n(809),d=n.n(c),f=n(2447),x=n(9669),h=n.n(x),m=n(8767),g=function(){var e=(0,m.useQuery)("cameraList",(0,f.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h().get("/api/camera/list");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:2e3});return null===e||void 0===e?void 0:e.data},p=n(381),v=n.n(p),j=function(e){var t=e.id,n=e.lastRequest,a=(e.config,v()(n).local().format("L HH:mm:ss"));return(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{style:{background:"white",position:"absolute",color:"black",zIndex:999,padding:8,borderBottomRightRadius:8},children:a}),(0,r.jsx)("img",{src:"/api/camera/lastimage/"+t+"?lastRequest=".concat(n),alt:"Camera"})]})},b=(n(9207),function(){var e=g();return e?(0,r.jsx)(u.lr,{autoPlay:!0,showThumbs:!1,infiniteLoop:!0,children:e.map((function(e){return(0,r.jsxs)("div",{children:[(0,r.jsx)(j,{id:e.id,config:e.config,lastRequest:e.lastRequest}),(0,r.jsx)("p",{className:"legend",children:e.config.name})]},e.id+e.config.name)}))}):null}),Z=n(9552),y=n(8610),w=n(5675),L=n(5530),M=h().create({baseURL:"/api/door/"}),C=function(){var e,t=(0,m.useQuery)("doorStatus",(0,f.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.get("status");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:3e3}),n=t.data,r=t.isLoading,a=(0,L.N)();return{state:null===n||void 0===n?void 0:n.state,isMoving:"stop"!==(null===n||void 0===n?void 0:n.status),nextAutomation:(null===n||void 0===n||null===(e=n.nextAutomation)||void 0===e?void 0:e[0])||{},isLoading:r,open:function(){return a().then((function(){return M.get("up")}))},close:function(){return a().then((function(){return M.get("down")}))}}},_={src:"/_next/static/image/public/open-lock.8d0f97ef90dfe5a4445f91a6e6ca2793.svg",height:36,width:36},H={src:"/_next/static/image/public/lock.48b64215e7effd06a93753c69c9c46bb.svg",height:36,width:36},k=function(){var e=C(),t=e.state,n=e.nextAutomation,s=e.isLoading,i=e.isMoving,o=e.open,l=e.close;if(s)return null;var u="top"===t,c=i?(0,r.jsx)(a.Z,{id:"Door.Moving",defaultMessage:"Moving\u2026"}):u?(0,r.jsx)(a.Z,{id:"Door.IsOpen",defaultMessage:"Opened"}):(0,r.jsx)(a.Z,{id:"Door.IsClose",defaultMessage:"Closed"});return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("b",{children:[(0,r.jsx)(a.Z,{id:"Door.State",defaultMessage:"State"})," :"," "]}),(0,r.jsx)("span",{style:{color:u?"green":i?"blue":"red"},children:c})]}),(0,r.jsxs)("div",{style:{color:"gray",fontSize:"75%"},children:["close"===n.action&&(0,r.jsx)(a.Z,{id:"Door.NextCloseAt",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)("b",{children:t})},time:v()(n.nextDate).local().format("HH:mm")},defaultMessage:"Next automatic <b>closing at {time}</b>"}),"open"===n.action&&(0,r.jsx)(a.Z,{id:"Door.NextOpenAt",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)("b",{children:t})},time:v()(n.nextDate).local().format("HH:mm")},defaultMessage:"Next automatic <b>opening at {time}</b>"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{style:{margin:"0 auto",width:56,height:56},children:i?(0,r.jsx)(Z.Z,{}):(0,r.jsx)(w.default,{src:u?_:H,alt:t,layout:"responsive"})}),(0,r.jsx)("br",{}),!i&&(0,r.jsxs)("div",{children:[!u&&(0,r.jsx)(y.Z,{onClick:o,fullWidth:!0,variant:"outlined",size:"small",children:(0,r.jsx)(a.Z,{id:"Door.Open",defaultMessage:"Open"})}),u&&(0,r.jsx)(y.Z,{onClick:l,fullWidth:!0,variant:"outlined",size:"small",children:(0,r.jsx)(a.Z,{id:"Door.Close",defaultMessage:"Close"})})]})]})},T={primary:"#fc7100"},N={src:"/_next/static/image/public/logo.a7814df0f364f91fca45a29183d26127.svg",height:72,width:72},A=function(){var e=(0,r.jsx)("div",{style:{fontSize:24,display:"inline-block",position:"relative",top:1,left:-3,width:25,overflow:"hidden"},children:"\ud83e\udd5a"});return(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",borderBottom:"1px solid lightgray",paddingBottom:4,marginBottom:16},children:[(0,r.jsx)(w.default,{src:N,alt:"NAME"}),(0,r.jsxs)("div",{style:{fontSize:36,fontWeight:600},children:[(0,r.jsx)("span",{style:{color:T.primary},children:"S"}),"mart","  ",(0,r.jsxs)("span",{style:{color:T.primary},children:["K",e,"tK",e,"t"]})]})]})},O=n(9378),S=n(5022),D=n(2734),z=n.n(D),P=function(e){var t=e.content,n=e.title,a=e.actions;return(0,r.jsx)(O.Z,{children:(0,r.jsxs)(S.Z,{children:[(0,r.jsxs)("div",{className:z().titleCard,children:[(0,r.jsx)("div",{children:n}),(0,r.jsx)("div",{children:a})]}),t]})})},R=h().create({baseURL:"/api/light/"}),I=function(){var e,t=(0,m.useQuery)("lightStatus",(0,f.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.get("status");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:3e3}),n=t.data,r=t.isLoading,a=t.refetch,s=(0,L.N)();return{state:null===n||void 0===n?void 0:n.state,nextAutomation:(null===n||void 0===n||null===(e=n.nextAutomation)||void 0===e?void 0:e[0])||{},isLoading:r,on:function(){return s().then((0,f.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.get("on");case 2:return t=e.sent,a(),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))))},off:function(){return s().then((0,f.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.get("off");case 2:return t=e.sent,a(),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))))}}},E={src:"/_next/static/image/public/light-on.c8b6abba956bd7832801554f7fe5bfa2.svg",height:72,width:72},W={src:"/_next/static/image/public/light-off.03408c6d15ed253a59eca4acdba2e07a.svg",height:72,width:72},Q=function(){var e=I(),t=e.state,n=e.nextAutomation,s=e.isLoading,i=e.on,o=e.off;if(s)return null;var l="on"===t,u=l?(0,r.jsx)(a.Z,{id:"Light.IsOn",defaultMessage:"On"}):(0,r.jsx)(a.Z,{id:"Light.IsOff",defaultMessage:"Off"});return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("b",{children:[(0,r.jsx)(a.Z,{id:"Light.State",defaultMessage:"State"})," :"," "]}),(0,r.jsx)("span",{style:{color:l?"green":"red"},children:u})]}),(0,r.jsxs)("div",{style:{color:"gray",fontSize:"75%"},children:["light_off"===n.action&&(0,r.jsx)(a.Z,{id:"Light.NextOffAt",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)("b",{children:t})},time:v()(n.nextDate).local().format("HH:mm")},defaultMessage:"Next automatic <b>switch off at {time}</b>"}),"light_on"===n.action&&(0,r.jsx)(a.Z,{id:"Light.NextOnAt",values:{b:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.jsx)("b",{children:t})},time:v()(n.nextDate).local().format("HH:mm")},defaultMessage:"Next automatic <b>switch on at {time}</b>"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{style:{margin:"0 auto",width:56,height:56},children:(0,r.jsx)(w.default,{src:l?E:W,layout:"responsive",alt:t})}),(0,r.jsx)("br",{}),(0,r.jsxs)("div",{children:[!l&&(0,r.jsx)(y.Z,{onClick:i,fullWidth:!0,variant:"outlined",size:"small",children:(0,r.jsx)(a.Z,{id:"Light.On",defaultMessage:"On"})}),l&&(0,r.jsx)(y.Z,{onClick:o,fullWidth:!0,variant:"outlined",size:"small",children:(0,r.jsx)(a.Z,{id:"Light.Off",defaultMessage:"Off"})})]})]})},q=n(3265),B=n(1492),U=n(9326),X=n(1166),K=n(2303),F=n(5152),G=n(6896),J=h().create({baseURL:"/api/temperature/"}),V=function(){var e=(0,m.useQuery)("temperatureLogs",(0,f.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,J.get("logs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{enabled:!1}),t=e.data,n=void 0===t?[]:t,r=e.refetch,a=e.isLoading,s=(0,G.Z)().formatMessage,i=[],o=[];return n.forEach((function(e){var t=1e3*Number(v().utc(e.date).local().format("X"));i.push([t,e.temp]),o.push([t,e.hum])})),{series:[{name:s({id:"Temperature.Temperature",defaultMessage:"Temperature"}),data:i},{name:s({id:"Temperature.Humidity",defaultMessage:"Humidity"}),data:o}],isLoading:a,refetch:r}},Y=h().create({baseURL:"/api/temperature/"}),$=function(){var e=(0,m.useQuery)("temperatureStatus",(0,f.Z)(d().mark((function e(){var t;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y.get("status");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:6e4}),t=e.data,n=e.isLoading;return{actualTemp:null===t||void 0===t?void 0:t.actualTemp,actualHum:null===t||void 0===t?void 0:t.actualHum,date:null===t||void 0===t?void 0:t.date,isLoading:n}},ee=function(){var e=$(),t=e.date,n=e.actualTemp,s=e.actualHum,i=n>=5&&n<=36,o=v()(t).local().format("L - HH[h]mm");return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(a.Z,{id:"Temperature.ActualTemp",defaultMessage:"Current temperature"})," ",":"," ",(0,r.jsxs)("span",{style:{color:i?"green":"red",fontSize:"140%"},children:[n,"\xb0"]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(a.Z,{id:"Temperature.ActualHum",defaultMessage:"Current humidity"})," ",":"," ",(0,r.jsxs)("span",{style:{color:i?"green":"red"},children:[s,"%"]})]}),(0,r.jsx)("br",{}),(0,r.jsx)("div",{style:{color:"gray",fontSize:"75%"},children:(0,r.jsx)(a.Z,{id:"Temperature.LastRead",defaultMessage:"Last reading at {date}",values:{date:o}})})]})},te=n(4214),ne=n(2510),re=function(){var e=(0,l.useState)(!1),t=e[0],i=e[1],o=V(),u=o.series,c=o.refetch,d=(0,G.Z)(),f=d.formatMessage,x=d.locale,h=[(0,r.jsx)(s.Z,{size:"small",onClick:function(){c(),i(!0)},children:(0,r.jsx)(K.Z,{})},"chart")],m=(0,F.default)((function(){return Promise.all([n.e(279),n.e(229)]).then(n.bind(n,7229))}),{ssr:!1,loadableGenerated:{webpack:function(){return[7229]},modules:["../components/TemperatureCard.tsx -> react-apexcharts"]}});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(q.Z,{open:t,fullWidth:!0,children:[(0,r.jsx)(B.Z,{children:(0,r.jsx)(a.Z,{id:"Temperature.Chart",defaultMessage:"Temperature Logs"})}),(0,r.jsx)(U.Z,{children:(0,r.jsx)(m,{options:{chart:{locales:[te,ne],defaultLocale:String(x)},xaxis:{type:"datetime"},yaxis:[{title:{text:f({id:"Temperature.Celsius",defaultMessage:"Celsius (\xb0)"})},min:-10,max:45,labels:{formatter:function(e){return"".concat(e,"\xb0")}}},{opposite:!0,title:{text:f({id:"Temperature.Percent",defaultMessage:"Percent (%)"})},min:0,max:100,labels:{formatter:function(e){return"".concat(e,"%")}}}],tooltip:{x:{formatter:function(e){return v()(e).format("LLLL")}}}},series:u,width:"100%"})}),(0,r.jsx)(X.Z,{children:(0,r.jsx)(y.Z,{onClick:function(){return i(!1)},children:(0,r.jsx)(a.Z,{id:"Actions.Close",defaultMessage:"Close"})})})]}),(0,r.jsx)(P,{title:(0,r.jsx)(a.Z,{id:"Home.Temperature",defaultMessage:"Temperature"}),content:(0,r.jsx)(ee,{}),actions:h})]})},ae=n(5323),se=n.n(ae);function ie(){var e=[(0,r.jsx)(s.Z,{size:"small",children:(0,r.jsx)(o.Z,{})},"settings")];return(0,r.jsxs)("div",{className:se().container,children:[(0,r.jsx)(A,{}),(0,r.jsxs)(i.ZP,{container:!0,spacing:4,children:[(0,r.jsx)(i.ZP,{item:!0,xs:12,sm:9,children:(0,r.jsx)(P,{title:(0,r.jsx)(a.Z,{id:"Home.Cameras",defaultMessage:"Cameras"}),content:(0,r.jsx)(b,{})})}),(0,r.jsx)(i.ZP,{item:!0,xs:12,sm:3,children:(0,r.jsxs)(i.ZP,{container:!0,spacing:4,children:[(0,r.jsx)(i.ZP,{item:!0,xs:12,children:(0,r.jsx)(P,{title:(0,r.jsx)(a.Z,{id:"Home.Door",defaultMessage:"Door"}),content:(0,r.jsx)(k,{}),actions:e})}),(0,r.jsx)(i.ZP,{item:!0,xs:12,children:(0,r.jsx)(P,{title:(0,r.jsx)(a.Z,{id:"Home.Light",defaultMessage:"Light"}),content:(0,r.jsx)(Q,{})})}),(0,r.jsx)(i.ZP,{item:!0,xs:12,children:(0,r.jsx)(re,{})})]})})]})]})}},5301:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(6286)}])},5323:function(e){e.exports={titleCard:"Home_titleCard__35HKW"}},2734:function(e){e.exports={titleCard:"HomeCard_titleCard__2mvLR",actions:"HomeCard_actions__2gAXT"}}},function(e){e.O(0,[774,745,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);