(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{7556:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return je}});var n=a(5893),r=a(4012),s=a(1788),i=a(9586),o=a(9969),l=a(800),c=a(1492),u=a(9326),d=a(1166),f=a(8610),x=a(7294),h=a(4662),m=a(9946),g=function(){var e=(0,h.Z)(),t=(0,m.Z)(e.breakpoints.down("sm")),a=(0,m.Z)("(orientation: landscape)"),n=(0,m.Z)(e.breakpoints.up("md"));return{isMobile:t,isLandscape:a&&!n}},p=a(5473),j=a(2752),v=a(1482),b=a(117),Z=a(6896),y=a(615),w=a(809),C=a.n(w),M=a(2447),L=a(9669),H=a.n(L),k=a(8767),_=function(e){var t=(0,k.useQuery)("cameraHistory",(0,M.Z)(C().mark((function t(){var a;return C().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H().get("/api/camera/images/".concat(e,"/list"));case 2:return a=t.sent,t.abrupt("return",a.data);case 4:case"end":return t.stop()}}),t)}))));return(null===t||void 0===t?void 0:t.data)||[]},T=function(){var e=(0,k.useQuery)("cameraList",(0,M.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H().get("/api/camera/list");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:2e3});return null===e||void 0===e?void 0:e.data},S=a(381),N=a.n(S),A=function(e){var t=e.id,a=e.lastRequest,r=e.imageId,s=void 0===r?"last":r,i=N()(a).local().format("L HH:mm:ss");return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{style:{background:"white",position:"absolute",color:"black",zIndex:999,padding:8,borderBottomRightRadius:8},children:i}),(0,n.jsx)("img",{src:"/api/camera/images/".concat(t,"/").concat(s,"?lastRequest=").concat(a),alt:"Camera",loading:"lazy"})]})},O=function(){var e=(0,x.useState)("0"),t=e[0],a=e[1],s=T(),i=_(t),o=(0,Z.Z)().formatMessage,l=g(),c=l.isMobile,u=l.isLandscape;return(0,n.jsxs)("div",{children:[(0,n.jsxs)(p.Z,{fullWidth:!0,children:[(0,n.jsxs)(j.Z,{id:"camera-list-label",children:[(0,n.jsx)(r.Z,{id:"Camera.SelectCamera",defaultMessage:"Choose the camera"})," ",":"]}),(0,n.jsx)(v.Z,{labelId:"camera-list-label",value:t,onChange:function(e){a(e.target.value)},label:o({id:"Camera.SelectCamera",defaultMessage:"Choose the camera"}),children:s.filter((function(e){var t;return!(null===(t=e.config.save)||void 0===t||!t.path)})).map((function(e){return(0,n.jsx)(b.Z,{value:e.id,children:e.config.name},e.id)}))})]}),(0,n.jsx)("div",{style:{width:c||u?"100%":"69vw",margin:"0 auto"},children:(0,n.jsx)(y.lr,{showThumbs:!1,showIndicators:!1,autoPlay:!1,children:i.map((function(e){return(0,n.jsx)(A,{id:t,imageId:e,lastRequest:1e3*Number(e.split(".")[0])},e)}))})})]})},z=x.memo(O),D=(a(9207),function(){var e=T();return e?(0,n.jsx)(y.lr,{autoPlay:!0,showThumbs:!1,infiniteLoop:!0,children:e.map((function(e){return(0,n.jsxs)("div",{children:[(0,n.jsx)(A,{id:e.id,lastRequest:e.lastRequest}),(0,n.jsx)("p",{className:"legend",children:e.config.name})]},e.id+e.config.name)}))}):null}),I=a(9378),P=a(5022),R=a(2734),W=a.n(R),E=function(e){var t=e.content,a=e.title,r=e.actions;return(0,n.jsx)(I.Z,{children:(0,n.jsxs)(P.Z,{children:[(0,n.jsxs)("div",{className:W().titleCard,children:[(0,n.jsx)("div",{children:a}),(0,n.jsx)("div",{children:r})]}),t]})})},Q=a(7342),q=function(){var e=(0,x.useState)(!1),t=e[0],a=e[1],i=g(),o=(i.isMobile,i.isLandscape,[(0,n.jsx)(s.Z,{size:"small",onClick:function(){a(!0)},children:(0,n.jsx)(Q.Z,{})},"chart")]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.Z,{open:t,fullScreen:!0,children:[(0,n.jsx)(c.Z,{children:(0,n.jsx)(r.Z,{id:"Camera.History",defaultMessage:"Camera History"})}),(0,n.jsxs)(u.Z,{children:[(0,n.jsx)("br",{}),(0,n.jsx)(z,{})]}),(0,n.jsx)(d.Z,{children:(0,n.jsx)(f.Z,{onClick:function(){return a(!1)},children:(0,n.jsx)(r.Z,{id:"Actions.Close",defaultMessage:"Close"})})})]}),(0,n.jsx)(E,{title:(0,n.jsx)(r.Z,{id:"Home.Cameras",defaultMessage:"Cameras"}),content:(0,n.jsx)(D,{}),actions:o})]})},B=a(9552),U=a(5675),X=a(5530),K=H().create({baseURL:"/api/door/"}),F=function(){var e,t=(0,k.useQuery)("doorStatus",(0,M.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.get("status");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:3e3}),a=t.data,n=t.isLoading,r=(0,X.N)();return{state:null===a||void 0===a?void 0:a.state,isMoving:"stop"!==(null===a||void 0===a?void 0:a.status),nextAutomation:(null===a||void 0===a||null===(e=a.nextAutomation)||void 0===e?void 0:e[0])||{},isLoading:n,open:function(){return r().then((function(){return K.get("up")}))},close:function(){return r().then((function(){return K.get("down")}))}}},G={src:"/_next/static/image/public/open-lock.8d0f97ef90dfe5a4445f91a6e6ca2793.svg",height:36,width:36},J={src:"/_next/static/image/public/lock.48b64215e7effd06a93753c69c9c46bb.svg",height:36,width:36},V=function(){var e=F(),t=e.state,a=e.nextAutomation,s=e.isLoading,i=e.isMoving,o=e.open,l=e.close;if(s)return null;var c="top"===t,u=i?(0,n.jsx)(r.Z,{id:"Door.Moving",defaultMessage:"Moving\u2026"}):c?(0,n.jsx)(r.Z,{id:"Door.IsOpen",defaultMessage:"Opened"}):(0,n.jsx)(r.Z,{id:"Door.IsClose",defaultMessage:"Closed"});return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("b",{children:[(0,n.jsx)(r.Z,{id:"Door.State",defaultMessage:"State"})," :"," "]}),(0,n.jsx)("span",{style:{color:c?"green":i?"blue":"red"},children:u})]}),(0,n.jsxs)("div",{style:{color:"gray",fontSize:"75%"},children:["close"===a.action&&(0,n.jsx)(r.Z,{id:"Door.NextCloseAt",values:{b:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.jsx)("b",{children:t})},time:N()(a.nextDate).local().format("HH:mm")},defaultMessage:"Next automatic <b>closing at {time}</b>"}),"open"===a.action&&(0,n.jsx)(r.Z,{id:"Door.NextOpenAt",values:{b:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.jsx)("b",{children:t})},time:N()(a.nextDate).local().format("HH:mm")},defaultMessage:"Next automatic <b>opening at {time}</b>"})]}),(0,n.jsx)("br",{}),(0,n.jsx)("div",{style:{margin:"0 auto",width:56,height:56},children:i?(0,n.jsx)(B.Z,{}):(0,n.jsx)(U.default,{src:c?G:J,alt:t,layout:"responsive"})}),(0,n.jsx)("br",{}),!i&&(0,n.jsxs)("div",{children:[!c&&(0,n.jsx)(f.Z,{onClick:o,fullWidth:!0,variant:"outlined",size:"small",children:(0,n.jsx)(r.Z,{id:"Door.Open",defaultMessage:"Open"})}),c&&(0,n.jsx)(f.Z,{onClick:l,fullWidth:!0,variant:"outlined",size:"small",children:(0,n.jsx)(r.Z,{id:"Door.Close",defaultMessage:"Close"})})]})]})},Y={primary:"#fc7100"},$={src:"/_next/static/image/public/logo.a7814df0f364f91fca45a29183d26127.svg",height:72,width:72},ee=function(){var e=(0,n.jsx)("div",{style:{fontSize:24,display:"inline-block",position:"relative",top:1,left:-3,width:25,overflow:"hidden"},children:"\ud83e\udd5a"});return(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",borderBottom:"1px solid lightgray",paddingBottom:4,marginBottom:16},children:[(0,n.jsx)(U.default,{src:$,alt:"NAME"}),(0,n.jsxs)("div",{style:{fontSize:36,fontWeight:600},children:[(0,n.jsx)("span",{style:{color:Y.primary},children:"S"}),"mart","  ",(0,n.jsxs)("span",{style:{color:Y.primary},children:["K",e,"tK",e,"t"]})]})]})},te=H().create({baseURL:"/api/light/"}),ae=function(){var e,t=(0,k.useQuery)("lightStatus",(0,M.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.get("status");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:3e3}),a=t.data,n=t.isLoading,r=t.refetch,s=(0,X.N)();return{state:null===a||void 0===a?void 0:a.state,nextAutomation:(null===a||void 0===a||null===(e=a.nextAutomation)||void 0===e?void 0:e[0])||{},isLoading:n,on:function(){return s().then((0,M.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.get("on");case 2:return t=e.sent,r(),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))))},off:function(){return s().then((0,M.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te.get("off");case 2:return t=e.sent,r(),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)}))))}}},ne={src:"/_next/static/image/public/light-on.c8b6abba956bd7832801554f7fe5bfa2.svg",height:72,width:72},re={src:"/_next/static/image/public/light-off.03408c6d15ed253a59eca4acdba2e07a.svg",height:72,width:72},se=function(){var e=ae(),t=e.state,a=e.nextAutomation,s=e.isLoading,i=e.on,o=e.off;if(s)return null;var l="on"===t,c=l?(0,n.jsx)(r.Z,{id:"Light.IsOn",defaultMessage:"On"}):(0,n.jsx)(r.Z,{id:"Light.IsOff",defaultMessage:"Off"});return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("b",{children:[(0,n.jsx)(r.Z,{id:"Light.State",defaultMessage:"State"})," :"," "]}),(0,n.jsx)("span",{style:{color:l?"green":"red"},children:c})]}),(0,n.jsxs)("div",{style:{color:"gray",fontSize:"75%"},children:["light_off"===a.action&&(0,n.jsx)(r.Z,{id:"Light.NextOffAt",values:{b:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.jsx)("b",{children:t})},time:N()(a.nextDate).local().format("HH:mm")},defaultMessage:"Next automatic <b>switch off at {time}</b>"}),"light_on"===a.action&&(0,n.jsx)(r.Z,{id:"Light.NextOnAt",values:{b:function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.jsx)("b",{children:t})},time:N()(a.nextDate).local().format("HH:mm")},defaultMessage:"Next automatic <b>switch on at {time}</b>"})]}),(0,n.jsx)("br",{}),(0,n.jsx)("div",{style:{margin:"0 auto",width:56,height:56},children:(0,n.jsx)(U.default,{src:l?ne:re,layout:"responsive",alt:t})}),(0,n.jsx)("br",{}),(0,n.jsxs)("div",{children:[!l&&(0,n.jsx)(f.Z,{onClick:i,fullWidth:!0,variant:"outlined",size:"small",children:(0,n.jsx)(r.Z,{id:"Light.On",defaultMessage:"On"})}),l&&(0,n.jsx)(f.Z,{onClick:o,fullWidth:!0,variant:"outlined",size:"small",children:(0,n.jsx)(r.Z,{id:"Light.Off",defaultMessage:"Off"})})]})]})},ie=a(2303),oe=a(5152),le=H().create({baseURL:"/api/temperature/"}),ce=function(){var e=(0,k.useQuery)("temperatureLogs",(0,M.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.get("logs");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{enabled:!1}),t=e.data,a=void 0===t?[]:t,n=e.refetch,r=e.isLoading,s=(0,Z.Z)().formatMessage,i=[],o=[];return a.forEach((function(e){var t=1e3*Number(N().utc(e.date).local().format("X"));i.push([t,e.temp]),o.push([t,e.hum])})),{series:[{name:s({id:"Temperature.Temperature",defaultMessage:"Temperature"}),data:i},{name:s({id:"Temperature.Humidity",defaultMessage:"Humidity"}),data:o}],isLoading:r,refetch:n}},ue=H().create({baseURL:"/api/temperature/"}),de=function(){var e=(0,k.useQuery)("temperatureStatus",(0,M.Z)(C().mark((function e(){var t;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ue.get("status");case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)}))),{refetchInterval:6e4}),t=e.data,a=e.isLoading;return{actualTemp:null===t||void 0===t?void 0:t.actualTemp,actualHum:null===t||void 0===t?void 0:t.actualHum,date:null===t||void 0===t?void 0:t.date,isLoading:a}},fe=function(){var e=de(),t=e.date,a=e.actualTemp,s=e.actualHum,i=a>=5&&a<=36,o=N()(t).local().format("L - HH[h]mm");return(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(r.Z,{id:"Temperature.ActualTemp",defaultMessage:"Current temperature"})," ",":"," ",(0,n.jsxs)("span",{style:{color:i?"green":"red",fontSize:"140%"},children:[a,"\xb0"]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)(r.Z,{id:"Temperature.ActualHum",defaultMessage:"Current humidity"})," ",":"," ",(0,n.jsxs)("span",{style:{color:i?"green":"red"},children:[s,"%"]})]}),(0,n.jsx)("br",{}),(0,n.jsx)("div",{style:{color:"gray",fontSize:"75%"},children:(0,n.jsx)(r.Z,{id:"Temperature.LastRead",defaultMessage:"Last reading at {date}",values:{date:o}})})]})},xe=a(4214),he=a(2510),me=function(){var e=(0,x.useState)(!1),t=e[0],i=e[1],o=ce(),h=o.series,m=o.refetch,p=(0,Z.Z)(),j=p.formatMessage,v=p.locale,b=g(),y=b.isMobile,w=b.isLandscape,C=[(0,n.jsx)(s.Z,{size:"small",onClick:function(){m(),i(!0)},children:(0,n.jsx)(ie.Z,{})},"chart")],M=(0,oe.default)((function(){return Promise.all([a.e(279),a.e(229)]).then(a.bind(a,7229))}),{ssr:!1,loadableGenerated:{webpack:function(){return[7229]},modules:["../components/TemperatureCard.tsx -> react-apexcharts"]}});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.Z,{open:t,fullWidth:!0,fullScreen:y||w,children:[(0,n.jsx)(c.Z,{children:(0,n.jsx)(r.Z,{id:"Temperature.Chart",defaultMessage:"Temperature Logs"})}),(0,n.jsx)(u.Z,{children:(0,n.jsx)(M,{options:{chart:{locales:[xe,he],defaultLocale:String(v)},xaxis:{type:"datetime"},yaxis:[{title:{text:j({id:"Temperature.Celsius",defaultMessage:"Celsius (\xb0)"})},min:-10,max:45,labels:{formatter:function(e){return"".concat(e,"\xb0")}}},{opposite:!0,title:{text:j({id:"Temperature.Percent",defaultMessage:"Percent (%)"})},min:0,max:100,labels:{formatter:function(e){return"".concat(e,"%")}}}],tooltip:{x:{formatter:function(e){return N()(e).format("LLLL")}}}},series:h,width:"100%"})}),(0,n.jsx)(d.Z,{children:(0,n.jsx)(f.Z,{onClick:function(){return i(!1)},children:(0,n.jsx)(r.Z,{id:"Actions.Close",defaultMessage:"Close"})})})]}),(0,n.jsx)(E,{title:(0,n.jsx)(r.Z,{id:"Home.Temperature",defaultMessage:"Temperature"}),content:(0,n.jsx)(fe,{}),actions:C})]})},ge=a(5323),pe=a.n(ge);function je(){var e=[(0,n.jsx)(s.Z,{size:"small",children:(0,n.jsx)(o.Z,{})},"settings")];return(0,n.jsxs)("div",{className:pe().container,children:[(0,n.jsx)(ee,{}),(0,n.jsxs)(i.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:9,children:(0,n.jsx)(q,{})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,sm:3,children:(0,n.jsxs)(i.ZP,{container:!0,spacing:4,children:[(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(E,{title:(0,n.jsx)(r.Z,{id:"Home.Door",defaultMessage:"Door"}),content:(0,n.jsx)(V,{}),actions:e})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(E,{title:(0,n.jsx)(r.Z,{id:"Home.Light",defaultMessage:"Light"}),content:(0,n.jsx)(se,{})})}),(0,n.jsx)(i.ZP,{item:!0,xs:12,children:(0,n.jsx)(me,{})})]})})]})]})}},5301:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(7556)}])},5323:function(e){e.exports={titleCard:"Home_titleCard__35HKW"}},2734:function(e){e.exports={titleCard:"HomeCard_titleCard__2mvLR",actions:"HomeCard_actions__2gAXT"}}},function(e){e.O(0,[774,473,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);